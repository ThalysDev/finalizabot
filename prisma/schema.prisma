generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Player {
  id            String              @id @default(cuid())
  sofascoreId   String              @unique
  name          String
  position      String
  sofascoreUrl  String
  createdAt     DateTime            @default(now())
  updatedAt     DateTime            @updatedAt

  matchStats    PlayerMatchStats[]
  marketAnalyses MarketAnalysis[]
}

model Match {
  id            String              @id @default(cuid())
  sofascoreId   String              @unique
  homeTeam      String
  awayTeam      String
  competition   String
  matchDate     DateTime
  status        String              @default("scheduled")
  createdAt     DateTime            @default(now())
  updatedAt     DateTime            @updatedAt

  playerStats   PlayerMatchStats[]
  marketAnalyses MarketAnalysis[]
}

model PlayerMatchStats {
  id          String   @id @default(cuid())
  playerId    String
  matchId     String
  goals       Int      @default(0)
  assists     Int      @default(0)
  shots       Int      @default(0)
  shotsOnTarget Int    @default(0)
  minutesPlayed Int    @default(0)
  rating      Float?
  createdAt   DateTime @default(now())

  player      Player   @relation(fields: [playerId], references: [id])
  match       Match    @relation(fields: [matchId], references: [id])

  @@unique([playerId, matchId])
}

model MarketAnalysis {
  id          String   @id @default(cuid())
  playerId    String
  matchId     String
  market      String
  odds        Float
  probability Float
  confidence  Float
  recommendation String
  reasoning   String
  createdAt   DateTime @default(now())

  player      Player   @relation(fields: [playerId], references: [id])
  match       Match    @relation(fields: [matchId], references: [id])
}